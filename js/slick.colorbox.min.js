/**
 * @file
 * Provides colorbox integration.
 */

!function(o,e,i){"use strict";e.slickColorbox=e.slickColorbox||{};var t,l=o(i);e.behaviors.slickColorbox={attach:function(t,a){if(o.isFunction(o.colorbox)){if(a.colorbox.mobiledetect&&i.matchMedia){var s=i.matchMedia("(max-device-width: "+a.colorbox.mobiledevicewidth+")");if(s.matches)return}o(".slick__slide .slick__colorbox",t).once("slick-colorbox",function(){var i,l=o(this),s=l.attr("href"),c=l.closest(".slick").attr("id"),n=o("#"+c).length,r=o("body"),d=l.data("media")||{},x=l.closest(".slick__slider","#"+c+".slick"),h="image"!==d.type?!0:!1,b={iframe:h,rel:d.rel||null,onOpen:function(){r.addClass("colorbox-on colorbox-on--"+d.type),r.data("mediaHeight",""),n&&x.slick("slickPause")},onLoad:function(){if(d=o(this).data("media"),"image"!==d.type&&r.data("mediaHeight",d.height),e.slickColorbox.removeClasses(),r.addClass("colorbox-on colorbox-on--"+d.type),n){if(i=parseInt(l.closest(".slick__slide:not(.slick-cloned)").data("slickIndex")),x.parent().next(".slick").length){var t=x.parent().next(".slick").find(".slick__slider");t.slick("slickGoTo",i)}x.slick("slickGoTo",i)}},onCleanup:function(){e.slickColorbox.removeClasses()},onComplete:function(){"image"!==d.type&&e.slickColorbox.resize(t,e.settings)},onClosed:function(){e.slickColorbox.jumpScroll("#"+c,120),e.slickColorbox.removeClasses(),r.data("mediaHeight","")}};h&&("soundcloud"===d.scheme?(s.indexOf("auto_play")<0||s.indexOf("auto_play")===!1)&&(s+="&auto_play=true"):(s.indexOf("autoplay")<0||0===s.indexOf("autoplay"))&&(s+="&autoplay=1"),l.attr("href",s)),l.colorbox(o.extend({},a.colorbox,b))}),l.bind("resize",function(){e.slickColorbox.resize(t,e.settings)}),o(t).bind("cbox_complete",function(){e.attachBehaviors("#cboxLoadedContent")})}}},e.slickColorbox.removeClasses=function(){o("body").removeClass("colorbox-on colorbox-on--image colorbox-on--video colorbox-on--audio")},e.slickColorbox.jumpScroll=function(e,i){o(e).length&&o("html, body").stop().animate({scrollTop:o(e).offset().top-i},800)},e.slickColorbox.resize=function(e,l){t&&clearTimeout(t);var a=l.colorbox.maxWidth,s=l.colorbox.maxHeight,c={width:"98%",height:"98%",maxWidth:a.indexOf("px")>0?parseInt(a):a,maxHeight:s.indexOf("px")>0?parseInt(s):s};t=setTimeout(function(){if(o("#cboxOverlay").is(":visible")){var e=o("#cboxLoadedContent"),t=o("> img, > iframe, > .node",e);o.colorbox.resize({width:i.innerWidth>c.maxWidth?c.maxWidth:c.width}),t.css({width:e.innerWidth(),height:"undefined"!==o("body").data("mediaHeight")?o("body").data("mediaHeight"):"auto"}),e.height(t.height()),o.colorbox.resize()}},0)}}(jQuery,Drupal,this,this.document);
